dalam chall ini kita check terlebih dahulu  petunjuk awal ada di robots.txt

kita diberi 2 informasi
ada file bernama admin dan juga ada server konfigurasi untuk membaca ekstensi .phps ini adalah ekstensi khusus yang biasa dikonfigurasi server untuk menampilkan source code berwarna alih alih mengeksekusi

jika admin.phps ada , maka index.phps juga ada

dalam web development 
jika satu file bisa diakses dari .phps, biasanya file utama (index.php) juga bisa dilihat dengan cara yang sama 

meskipun tadinya gagal membuka, normalnya bisa diakses dengan ekstenson .phps

membaca source code 
jika kita membuka source code dari index.phps 
kita tidak perlu menebak file lain
tpi kita sudah menemukan 2 file
yaitu cookie.php dan authentication.php

kata kunci require_once atau include memberitahu kita "hey halaman index ini tidak bisa jalan sendirian atau membutuhkan file ini untuk bekerja

kita ternyata dapat mengakses keduanya

dan kita diberi tahu bahwa flag ada di ../flag

tujuan kita adalaah membuat server membaca file ../file dan menampikan kepada kita

vurnerability : unserialize() yang tidak aman di cookie.php
payload : objek access_log yang properti $log_file nya diisi ..flag

triknya adalah kita sengaja membuat program error karena class access_log tidak mempunyai method is admin sehingga program masuk ke blok catch dan mencetak isi flag

saatnya membuat payload 

<?php
class access_log {
    public $log_file;
    function __construct($lf) {
        $this->log_file = $lf;
    }
}

// Target file flag relative terhadap script
$obj = new access_log("../flag");

// Serialize & Encode Base64
echo base64_encode(serialize($obj));
?>


hasil payload base64 adalah ....

kita lanjutkan 

langkah eksploitasi :

1. siapkan cookie 
kita buka tab aplication dan pilih cookies dan buatlah sebuah cookie bernama login

isi value dengan payload base64 diatas

save dan akses halaman yang tepat. jangan akses index.php dikarenakan class belum dimuat di serialisasi

akseslah authentication
kenapa? dikarenakan file ini memuat definisi class acces_log secara sempurna sehingga serialisasi cookie berhasil

lanjut kita refresh dan kita mendapatkan sudah flagnya
