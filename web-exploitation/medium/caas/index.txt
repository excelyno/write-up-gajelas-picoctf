dari potongan kode index.txt yang diberikan , kita dapat mengidentifikasi alur aplikasi sebagai berikut:

framework menggunakan aplikasi dibangun menggunakan express js
endpoint terdapat endpoint get /cowsay/:message
logika utama : aplikai mengambil input dari parameter url (req.params.message) dan memasukkan langsung kedalam fungsi exec

// Baris yang rentan:
exec(`/usr/games/cowsay ${req.params.message}`, ...

kerentanan utama adalah os command injection
fungsi exec dari modul child_process di node.js mengeksekusi perintah di dalam shell (/bin/sh) . karena input pengguna (req.params.message_ digabungkan langsung kedalam strings perintah tanpa sanitasi
penyerang dapat menggunakan karakter khusus shell (metacharacters)
untuk memanipulasi perintah tersebut

karakter injeksi yang umum digunakan :
; titik koma : menandakan akhir dari satu perintah dan awal dari perintah baru

| pipe : mengirim output perintah pertama ke perintah kedua

&& (and) : menjalankan perintah kedua setelah perintah pertama berhasil
$() atau ` : subtitusi perintah

tujuan kita adalah membaca file rahasia yang berada di server

pertama kita coba menyuntikan perintah utama sederhana seperti whoami atau ls untuk memastikan kita bisa menjalankan kode

kita akan menggunakan karakter ; untuk memisahkan perintah cowsay asli dengan perintah kita 
payload : test; ls

dan url nya disesuaikan


apa yang terjadi ? cowsay akan menjalankan test 
setelah itu akan menjalankan ls yang berarti akhir dari cowsay

setelah mendapatkan list file. maka ia akan muuncul list file yang ada flagnya

sesuaikan dan gunakan payload yang sama hanya saja ganti dengan cat file namanya apa

dengan begitu kita mendapatkan flagnya


