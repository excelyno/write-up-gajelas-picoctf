tshark -r myNetworkTraffic.pcap -Y "tcp.len==12 || tcp.len==4" -T fields -e frame.time -e tcp.segment_data | sort -k4 | awk '{print $6}' | xxd -p -r | base64 -d


jadi awalnya saya mencoba strings langsung aja dan emang betul ada beberapa kode dari base 64 yang menyusun flag. hanya saja tidak tahu urutannya bagaimana. 

1️⃣ Apa itu “payload” di dalam file .pcap?

Ketika komputer A mengirim data ke komputer B melalui internet, data itu dipotong-potong menjadi paket.
Di dalam setiap paket ada bagian penting bernama:

payload = isi sebenarnya yang dikirim (teks, gambar, file, potongan flag, dll).

Dalam kasus ini:

setiap paket TCP membawa potongan kecil

potongan ini disimpan dalam format Base64

beberapa paket tidak terkait flag

urutan paket berantakan

Jadi tugas kita adalah:

ambil payload,

pilih yang benar,

susun kembali,

decode dari Base64,

baca flag.

2️⃣ Mengambil payload dari semua paket
tshark -r myNetworkTraffic.pcap -Y "tcp" -T fields -e tcp.segment_data \
| xxd -p -r | base64 -d


Artinya:

tshark membaca file .pcap

kita ambil hanya payload TCP

payload masih dalam bentuk hex, lalu diubah ke biner

terakhir di-decode dari Base64

Masalahnya:

masih ikut payload “sampah” → flag salah.

3️⃣ Menyaring hanya paket yang berisi flag

Kita temukan pola:
Yang berisi potongan flag ternyata paket dengan panjang 12 byte.

tshark -r myNetworkTraffic.pcap -Y "tcp.len==12" -T fields -e tcp.segment_data \
| xxd -p -r | base64 -d


Ini sudah lebih baik — tetapi:

urutannya masih acak → flag belum terbaca sempurna.

4️⃣ Mengurutkan berdasarkan waktu (supaya susunannya benar)

Sekarang kita ambil:

waktu paket dikirim

payload-nya

lalu urutkan.

tshark -r myNetworkTraffic.pcap -Y "tcp.len==12 || tcp.len==4" \
-T fields -e frame.time_epoch -e tcp.segment_data \
| sort -n \
| cut -d' ' -f2 \
| xxd -p -r \
| base64 -d


Penjelasan sederhana:

ambil timestamp (angka detik) + payload

urutkan dari paling awal → paling akhir

ambil hanya payload

ubah hex → biner

decode Base64

flag muncul, utuh, dan terbaca

5️⃣ Mengapa ini berhasil? (logika sederhana)

Bayangkan flag dipotong seperti ini:

pi
co
CT
F{
se
cre
t}


Lalu dikirim acak, sebagian dikirim ulang, sebagian bukan bagian flag.

Yang kita lakukan:

saring potongan yang relevan

kembalikan urutan sesuai waktu

gabungkan

decode Base64

Hasilnya: flag kembali utuh.

6️⃣ Bagaimana ini bisa dikembangkan?

Beberapa peningkatan yang berguna:

✔️ Otomatisasi agar lebih cepat

Buat script Bash atau Python sehingga setiap kali dapat file .pcap, kamu tinggal jalankan:

./extract_flag.sh file.pcap

✔️ Gunakan “follow tcp stream” jika cocok

Di beberapa kasus, cukup:

Wireshark → Follow → TCP Stream
atau

tshark follow mode

tshark -q -z follow,tcp,raw,0 -r file.pcap

✔️ Bedakan tipe payload

Tidak selalu Base64. Bisa:

hex langsung

gzip

zlib

XOR sederhana

encoding custom

Karena itu, selalu cek dulu bentuk datanya.
